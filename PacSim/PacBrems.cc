//--------------------------------------------------------------------------
// Name:
//   PacBrems
//  Description:
//  Class to describe Bremsstrahlung
// Environment:
//   Software developed for PACRAT / SuperB
// Copyright Information:
//	 Copyright (C) 2010	Lawrence Berkeley Laboratory
// Author List:
//   Dave Brown 10 Feb 2010
//------------------------------------------------------------------------
#include "BaBar/BaBar.hh"
#include "PacSim/PacBrems.hh"
#include "PacEnv/PacConfig.hh"
#include "CLHEP/Random/Random.h"
#include "CLHEP/Random/RandFlat.h"
#include "CLHEP/Random/RandPoisson.h"
#include <assert.h>

// statics

const double PacBrems::_ft(4.0/3.0);
const double PacBrems::_ot(1.0/3.0);

PacBrems::PacBrems() 
{
// get config parameters
  _minegam = gconfig.getfloat("PacBrems.min_egamma",-1.0);
  _minefrac = gconfig.getfloat("PacBrems.min_efrac",-1.0);
  assert(_minegam > 0.0 && _minefrac > 0.0);
}

PacBrems::~PacBrems()
{
}

unsigned
PacBrems::nBrems(double radfrac, double& energy) const {
// calculate the fixed energy loss from infra-red photons.  there are an infinite # of these, so
// there is no spread to the value (for small minefrac)
  energy -= energy*elow(radfrac,_minefrac);
// compute the average # of photons above the minimum fractional cut
  double ng = ngam(radfrac,_minefrac);
// Poisson sample to get the actual # of photons
  unsigned ngam = RandPoisson::shoot(_randengine,ng);
  unsigned nghi(0);
// for each photon, select its energy fraction by sampling the inverse frequency distribution
  for(unsigned igam=0;igam<ngam;igam++){
    double egam = energy*invngam(RandFlat::shoot(_randengine));
// if the energy is high enough, count the photon.
    if(egam > _minegam) nghi++;
    energy -= egam;
  }
  return nghi;
}

//  Basic equations derrived from the PDG 2010, equatuion 27.28,
// which is valid for material thickness much less than 1 radlen.  Thicker materials can be modeled
// by subdivision.

// number spectrum of brems photons (dN/dy) in terms of the energy fraction of the photon
double
PacBrems::dndy(double radfrac,double efrac) {
  return radfrac*( _ft*(1.0/efrac - 1.0) + efrac);
}

// # of photons emitted with fractional energy above a given fraction.  This is the integral
// of the above from the faction to 1.0.
double
PacBrems::ngam(double radfrac, double efrac)  {
  return radfrac*( _ft*(efrac-log(efrac)-1.0) + 0.5*(1-efrac*efrac) );
}

// total photon energy fraction below a cut on the fractional energy.  This is the
// integral of the number density times the photon energy from 0 to the given cut
double
PacBrems::elow(double radfrac, double efrac) {
  return radfrac*( _ft*(efrac-0.5*efrac*efrac) + _ot*efrac*efrac*efrac);
}

// Spline fit to the Inverse of the integral bremsstralung photon number density (dndy) as a fuction of
// the photon energy fraction.  I used TSpline3 to generate a spline fit of the inverse, as
// the integral function is transcendental.
// 
double
PacBrems::invngam(double x) const {
   static const int fNp = 1000;
   static const double fDelta =0.001;
   static const double fXmin = 0.0005;
//   static const double fXmax = 0.9995;
   static const double fY[1000] = { 0.00100337, 0.00101012, 0.0010169, 0.0010237, 0.00103053,
                        0.00103738, 0.00104426, 0.00105117, 0.0010581, 0.00106506,
                        0.00107205, 0.00107906, 0.0010861, 0.00109318, 0.00110028,
                        0.00110742, 0.00111458, 0.00112178, 0.00112901, 0.00113627,
                        0.00114357, 0.0011509, 0.00115826, 0.00116566, 0.00117309,
                        0.00118057, 0.00118807, 0.00119562, 0.0012032, 0.00121082,
                        0.00121848, 0.00122617, 0.00123391, 0.00124169, 0.00124951,
                        0.00125737, 0.00126527, 0.00127322, 0.0012812, 0.00128924,
                        0.00129731, 0.00130543, 0.0013136, 0.00132181, 0.00133007,
                        0.00133837, 0.00134672, 0.00135512, 0.00136357, 0.00137206,
                        0.00138061, 0.00138921, 0.00139785, 0.00140655, 0.0014153,
                        0.0014241, 0.00143296, 0.00144187, 0.00145083, 0.00145984,
                        0.00146892, 0.00147804, 0.00148723, 0.00149646, 0.00150576,
                        0.00151511, 0.00152453, 0.001534, 0.00154353, 0.00155312,
                        0.00156277, 0.00157248, 0.00158225, 0.00159208, 0.00160198,
                        0.00161194, 0.00162196, 0.00163205, 0.0016422, 0.00165242,
                        0.0016627, 0.00167305, 0.00168346, 0.00169395, 0.0017045,
                        0.00171512, 0.0017258, 0.00173656, 0.00174739, 0.00175829,
                        0.00176926, 0.0017803, 0.00179141, 0.0018026, 0.00181385,
                        0.00182519, 0.00183659, 0.00184808, 0.00185963, 0.00187127,
                        0.00188298, 0.00189476, 0.00190663, 0.00191857, 0.00193059,
                        0.00194269, 0.00195487, 0.00196713, 0.00197947, 0.0019919,
                        0.0020044, 0.00201699, 0.00202966, 0.00204241, 0.00205525,
                        0.00206817, 0.00208118, 0.00209427, 0.00210745, 0.00212071,
                        0.00213407, 0.00214751, 0.00216104, 0.00217465, 0.00218836,
                        0.00220216, 0.00221605, 0.00223003, 0.0022441, 0.00225826,
                        0.00227252, 0.00228686, 0.00230131, 0.00231584, 0.00233047,
                        0.0023452, 0.00236002, 0.00237494, 0.00238996, 0.00240507,
                        0.00242029, 0.0024356, 0.00245101, 0.00246652, 0.00248213,
                        0.00249784, 0.00251365, 0.00252956, 0.00254558, 0.0025617,
                        0.00257792, 0.00259424, 0.00261068, 0.00262721, 0.00264385,
                        0.0026606, 0.00267746, 0.00269442, 0.00271149, 0.00272866,
                        0.00274595, 0.00276335, 0.00278085, 0.00279847, 0.0028162,
                        0.00283404, 0.00285199, 0.00287005, 0.00288823, 0.00290652,
                        0.00292492, 0.00294344, 0.00296208, 0.00298083, 0.0029997,
                        0.00301868, 0.00303779, 0.00305701, 0.00307635, 0.00309581,
                        0.00311539, 0.0031351, 0.00315493, 0.00317488, 0.00319496,
                        0.00321517, 0.0032355, 0.00325596, 0.00327655, 0.00329727,
                        0.00331812, 0.0033391, 0.00336022, 0.00338147, 0.00340285,
                        0.00342437, 0.00344602, 0.00346782, 0.00348975, 0.00351182,
                        0.00353403, 0.00355638, 0.00357887, 0.00360151, 0.00362429,
                        0.00364722, 0.00367029, 0.00369351, 0.00371687, 0.00374039,
                        0.00376405, 0.00378787, 0.00381183, 0.00383595, 0.00386022,
                        0.00388465, 0.00390923, 0.00393396, 0.00395886, 0.00398391,
                        0.00400912, 0.00403449, 0.00406002, 0.00408571, 0.00411157,
                        0.00413759, 0.00416377, 0.00419013, 0.00421665, 0.00424334,
                        0.0042702, 0.00429723, 0.00432443, 0.0043518, 0.00437936,
                        0.00440708, 0.00443499, 0.00446307, 0.00449133, 0.00451977,
                        0.00454839, 0.00457719, 0.00460618, 0.00463536, 0.00466472,
                        0.00469426, 0.004724, 0.00475392, 0.00478403, 0.00481434,
                        0.00484484, 0.00487553, 0.00490642, 0.0049375, 0.00496878,
                        0.00500026, 0.00503194, 0.00506382, 0.00509591, 0.00512819,
                        0.00516068, 0.00519338, 0.00522629, 0.00525941, 0.00529273,
                        0.00532627, 0.00536003, 0.00539399, 0.00542818, 0.00546258,
                        0.00549721, 0.00553205, 0.00556712, 0.00560241, 0.00563792,
                        0.00567366, 0.00570963, 0.00574583, 0.00578226, 0.00581892,
                        0.00585582, 0.00589295, 0.00593032, 0.00596793, 0.00600577,
                        0.00604386, 0.00608219, 0.00612076, 0.00615958, 0.00619865,
                        0.00623796, 0.00627753, 0.00631735, 0.00635742, 0.00639775,
                        0.00643834, 0.00647919, 0.0065203, 0.00656167, 0.00660331,
                        0.00664521, 0.00668738, 0.00672982, 0.00677253, 0.00681551,
                        0.00685877, 0.00690231, 0.00694612, 0.00699021, 0.00703458,
                        0.00707924, 0.00712418, 0.00716941, 0.00721493, 0.00726074,
                        0.00730684, 0.00735324, 0.00739993, 0.00744693, 0.00749422,
                        0.00754182, 0.00758972, 0.00763793, 0.00768645, 0.00773528,
                        0.00778442, 0.00783387, 0.00788364, 0.00793374, 0.00798415,
                        0.00803488, 0.00808594, 0.00813732, 0.00818904, 0.00824108,
                        0.00829346, 0.00834618, 0.00839923, 0.00845262, 0.00850636,
                        0.00856044, 0.00861487, 0.00866964, 0.00872477, 0.00878025,
                        0.00883609, 0.00889228, 0.00894884, 0.00900576, 0.00906304,
                        0.00912069, 0.00917872, 0.00923711, 0.00929588, 0.00935502,
                        0.00941455, 0.00947446, 0.00953475, 0.00959543, 0.0096565,
                        0.00971797, 0.00977982, 0.00984208, 0.00990474, 0.0099678,
                        0.0100313, 0.0100951, 0.0101594, 0.0102241, 0.0102892,
                        0.0103548, 0.0104207, 0.0104871, 0.0105539, 0.0106211,
                        0.0106888, 0.0107569, 0.0108254, 0.0108944, 0.0109639,
                        0.0110337, 0.0111041, 0.0111748, 0.0112461, 0.0113178,
                        0.0113899, 0.0114625, 0.0115356, 0.0116092, 0.0116832,
                        0.0117577, 0.0118327, 0.0119082, 0.0119842, 0.0120606,
                        0.0121376, 0.012215, 0.012293, 0.0123714, 0.0124504,
                        0.0125299, 0.0126098, 0.0126903, 0.0127714, 0.0128529,
                        0.012935, 0.0130176, 0.0131007, 0.0131844, 0.0132686,
                        0.0133534, 0.0134387, 0.0135245, 0.0136109, 0.0136979,
                        0.0137855, 0.0138736, 0.0139622, 0.0140515, 0.0141413,
                        0.0142317, 0.0143227, 0.0144143, 0.0145065, 0.0145993,
                        0.0146927, 0.0147867, 0.0148813, 0.0149765, 0.0150723,
                        0.0151688, 0.0152659, 0.0153636, 0.0154619, 0.0155609,
                        0.0156605, 0.0157608, 0.0158617, 0.0159633, 0.0160656,
                        0.0161685, 0.0162721, 0.0163763, 0.0164813, 0.0165869,
                        0.0166932, 0.0168002, 0.0169079, 0.0170163, 0.0171254,
                        0.0172352, 0.0173458, 0.017457, 0.017569, 0.0176817,
                        0.0177952, 0.0179094, 0.0180243, 0.01814, 0.0182564,
                        0.0183736, 0.0184916, 0.0186103, 0.0187299, 0.0188502,
                        0.0189712, 0.0190931, 0.0192158, 0.0193393, 0.0194636,
                        0.0195887, 0.0197146, 0.0198414, 0.0199689, 0.0200973,
                        0.0202266, 0.0203567, 0.0204877, 0.0206195, 0.0207522,
                        0.0208857, 0.0210202, 0.0211555, 0.0212917, 0.0214288,
                        0.0215668, 0.0217057, 0.0218456, 0.0219863, 0.022128,
                        0.0222706, 0.0224141, 0.0225586, 0.0227041, 0.0228505,
                        0.0229978, 0.0231462, 0.0232955, 0.0234458, 0.0235971,
                        0.0237494, 0.0239027, 0.024057, 0.0242124, 0.0243687,
                        0.0245261, 0.0246846, 0.0248441, 0.0250046, 0.0251662,
                        0.0253289, 0.0254926, 0.0256575, 0.0258234, 0.0259905,
                        0.0261586, 0.0263279, 0.0264982, 0.0266698, 0.0268424,
                        0.0270162, 0.0271912, 0.0273673, 0.0275446, 0.0277231,
                        0.0279027, 0.0280836, 0.0282656, 0.0284489, 0.0286334,
                        0.0288191, 0.0290061, 0.0291943, 0.0293838, 0.0295745,
                        0.0297666, 0.0299598, 0.0301544, 0.0303503, 0.0305475,
                        0.030746, 0.0309459, 0.0311471, 0.0313496, 0.0315535,
                        0.0317588, 0.0319654, 0.0321734, 0.0323829, 0.0325937,
                        0.0328059, 0.0330196, 0.0332347, 0.0334513, 0.0336693,
                        0.0338888, 0.0341098, 0.0343322, 0.0345562, 0.0347816,
                        0.0350086, 0.0352371, 0.0354672, 0.0356988, 0.035932,
                        0.0361667, 0.0364031, 0.036641, 0.0368806, 0.0371218,
                        0.0373646, 0.0376091, 0.0378552, 0.038103, 0.0383525,
                        0.0386036, 0.0388565, 0.0391111, 0.0393674, 0.0396255,
                        0.0398853, 0.0401469, 0.0404103, 0.0406755, 0.0409425,
                        0.0412113, 0.041482, 0.0417545, 0.0420289, 0.0423051,
                        0.0425832, 0.0428633, 0.0431453, 0.0434291, 0.043715,
                        0.0440028, 0.0442926, 0.0445843, 0.0448781, 0.0451739,
                        0.0454718, 0.0457717, 0.0460736, 0.0463776, 0.0466838,
                        0.046992, 0.0473024, 0.0476149, 0.0479296, 0.0482465,
                        0.0485655, 0.0488868, 0.0492103, 0.049536, 0.049864,
                        0.0501943, 0.0505268, 0.0508617, 0.0511989, 0.0515385,
                        0.0518804, 0.0522247, 0.0525714, 0.0529206, 0.0532721,
                        0.0536261, 0.0539826, 0.0543416, 0.0547032, 0.0550672,
                        0.0554338, 0.055803, 0.0561747, 0.0565491, 0.0569261,
                        0.0573057, 0.0576881, 0.0580731, 0.0584608, 0.0588513,
                        0.0592445, 0.0596406, 0.0600394, 0.060441, 0.0608455,
                        0.0612528, 0.0616631, 0.0620762, 0.0624923, 0.0629113,
                        0.0633334, 0.0637584, 0.0641864, 0.0646175, 0.0650517,
                        0.065489, 0.0659294, 0.066373, 0.0668197, 0.0672697,
                        0.0677228, 0.0681793, 0.068639, 0.069102, 0.0695683,
                        0.070038, 0.0705111, 0.0709876, 0.0714675, 0.0719509,
                        0.0724378, 0.0729282, 0.0734222, 0.0739197, 0.0744209,
                        0.0749257, 0.0754342, 0.0759464, 0.0764623, 0.076982,
                        0.0775055, 0.0780328, 0.0785639, 0.0790989, 0.0796379,
                        0.0801808, 0.0807277, 0.0812786, 0.0818336, 0.0823927,
                        0.0829558, 0.0835232, 0.0840947, 0.0846704, 0.0852504,
                        0.0858347, 0.0864234, 0.0870164, 0.0876138, 0.0882156,
                        0.088822, 0.0894328, 0.0900483, 0.0906683, 0.0912929,
                        0.0919222, 0.0925563, 0.0931951, 0.0938387, 0.0944871,
                        0.0951405, 0.0957987, 0.0964619, 0.0971301, 0.0978034,
                        0.0984818, 0.0991653, 0.099854, 0.100548, 0.101247,
                        0.101952, 0.102662, 0.103377, 0.104098, 0.104824,
                        0.105556, 0.106294, 0.107037, 0.107786, 0.10854,
                        0.109301, 0.110067, 0.11084, 0.111618, 0.112402,
                        0.113192, 0.113989, 0.114792, 0.115601, 0.116416,
                        0.117238, 0.118066, 0.118901, 0.119742, 0.120589,
                        0.121444, 0.122305, 0.123173, 0.124048, 0.12493,
                        0.125819, 0.126714, 0.127617, 0.128527, 0.129445,
                        0.13037, 0.131302, 0.132241, 0.133188, 0.134143,
                        0.135106, 0.136076, 0.137054, 0.13804, 0.139034,
                        0.140036, 0.141046, 0.142064, 0.143091, 0.144126,
                        0.145169, 0.146221, 0.147282, 0.148351, 0.149429,
                        0.150517, 0.151613, 0.152718, 0.153832, 0.154956,
                        0.156089, 0.157231, 0.158383, 0.159544, 0.160715,
                        0.161897, 0.163088, 0.164289, 0.1655, 0.166721,
                        0.167953, 0.169195, 0.170448, 0.171711, 0.172985,
                        0.174271, 0.175567, 0.176874, 0.178192, 0.179522,
                        0.180864, 0.182216, 0.183581, 0.184958, 0.186346,
                        0.187747, 0.189159, 0.190585, 0.192022, 0.193473,
                        0.194936, 0.196412, 0.197901, 0.199403, 0.200918,
                        0.202448, 0.20399, 0.205547, 0.207117, 0.208702,
                        0.2103, 0.211914, 0.213541, 0.215184, 0.216841,
                        0.218514, 0.220201, 0.221904, 0.223623, 0.225357,
                        0.227108, 0.228874, 0.230657, 0.232456, 0.234273,
                        0.236105, 0.237955, 0.239823, 0.241707, 0.24361,
                        0.24553, 0.247469, 0.249425, 0.251401, 0.253395,
                        0.255407, 0.25744, 0.259491, 0.261563, 0.263654,
                        0.265765, 0.267897, 0.270049, 0.272222, 0.274416,
                        0.276632, 0.278869, 0.281128, 0.28341, 0.285713,
                        0.28804, 0.290389, 0.292762, 0.295158, 0.297578,
                        0.300023, 0.302491, 0.304985, 0.307503, 0.310047,
                        0.312616, 0.315212, 0.317834, 0.320482, 0.323158,
                        0.32586, 0.328591, 0.331349, 0.334136, 0.336951,
                        0.339796, 0.34267, 0.345573, 0.348507, 0.351471,
                        0.354467, 0.357493, 0.360552, 0.363642, 0.366765,
                        0.369921, 0.37311, 0.376333, 0.37959, 0.382882,
                        0.386209, 0.389571, 0.392969, 0.396403, 0.399874,
                        0.403382, 0.406928, 0.410513, 0.414135, 0.417797,
                        0.421498, 0.42524, 0.429022, 0.432844, 0.436709,
                        0.440615, 0.444563, 0.448555, 0.45259, 0.456669,
                        0.460792, 0.46496, 0.469173, 0.473433, 0.477739,
                        0.482091, 0.486491, 0.490939, 0.495436, 0.499981,
                        0.504575, 0.50922, 0.513915, 0.51866, 0.523457,
                        0.528306, 0.533206, 0.53816, 0.543166, 0.548227,
                        0.553341, 0.558509, 0.563733, 0.569011, 0.574346,
                        0.579736, 0.585182, 0.590686, 0.596246, 0.601863,
                        0.607538, 0.613271, 0.619063, 0.624912, 0.63082,
                        0.636787, 0.642812, 0.648897, 0.65504, 0.661243,
                        0.667505, 0.673826, 0.680207, 0.686647, 0.693145,
                        0.699703, 0.706319, 0.712994, 0.719728, 0.726519,
                        0.733368, 0.740275, 0.747239, 0.754259, 0.761336,
                        0.768468, 0.775655, 0.782897, 0.790193, 0.797541,
                        0.804943, 0.812396, 0.8199, 0.827454, 0.835057,
                        0.842709, 0.850408, 0.858153, 0.865944, 0.873779,
                        0.881657, 0.889577, 0.897539, 0.90554, 0.913579,
                        0.921656, 0.929769, 0.937916, 0.946098, 0.954311,
                        0.962555, 0.970829, 0.979131, 0.98746, 0.995814 };
   static const double fB[1000] = { 0.0067433, 0.00676664, 0.00679052, 0.00681493, 0.00683989,
                        0.00686539, 0.00689142, 0.006918, 0.00694511, 0.00697277,
                        0.00700096, 0.0070297, 0.00705897, 0.00708879, 0.00711914,
                        0.00715003, 0.00718146, 0.00721344, 0.00724595, 0.007279,
                        0.00731259, 0.00734672, 0.00738139, 0.0074166, 0.00745235,
                        0.00748864, 0.00752547, 0.00756283, 0.00760074, 0.00763919,
                        0.00767818, 0.0077177, 0.00775777, 0.00779838, 0.00783952,
                        0.00788121, 0.00792343, 0.0079662, 0.0080095, 0.00805334,
                        0.00809773, 0.00814265, 0.00818811, 0.00823411, 0.00828066,
                        0.00832774, 0.00837536, 0.00842352, 0.00847222, 0.00852146,
                        0.00857124, 0.00862156, 0.00867242, 0.00872381, 0.00877575,
                        0.00882823, 0.00888125, 0.0089348, 0.0089889, 0.00904354,
                        0.00909871, 0.00915443, 0.00921068, 0.00926748, 0.00932481,
                        0.00938268, 0.0094411, 0.00950005, 0.00955954, 0.00961957,
                        0.00968015, 0.00974126, 0.00980291, 0.0098651, 0.00992783,
                        0.0099911, 0.0100549, 0.0101193, 0.0101841, 0.0102496,
                        0.0103155, 0.0103821, 0.0104491, 0.0105167, 0.0105848,
                        0.0106535, 0.0107227, 0.0107924, 0.0108627, 0.0109335,
                        0.0110049, 0.0110768, 0.0111493, 0.0112222, 0.0112958,
                        0.0113698, 0.0114444, 0.0115196, 0.0115952, 0.0116715,
                        0.0117482, 0.0118255, 0.0119034, 0.0119817, 0.0120607,
                        0.0121401, 0.0122201, 0.0123007, 0.0123817, 0.0124634,
                        0.0125455, 0.0126282, 0.0127114, 0.0127952, 0.0128795,
                        0.0129644, 0.0130498, 0.0131357, 0.0132222, 0.0133092,
                        0.0133968, 0.0134848, 0.0135735, 0.0136626, 0.0137524,
                        0.0138426, 0.0139334, 0.0140247, 0.0141166, 0.014209,
                        0.014302, 0.0143954, 0.0144895, 0.014584, 0.0146792,
                        0.0147748, 0.014871, 0.0149677, 0.015065, 0.0151628,
                        0.0152611, 0.01536, 0.0154594, 0.0155594, 0.0156599,
                        0.015761, 0.0158625, 0.0159647, 0.0160673, 0.0161705,
                        0.0162743, 0.0163785, 0.0164834, 0.0165887, 0.0166946,
                        0.0168011, 0.016908, 0.0170156, 0.0171236, 0.0172322,
                        0.0173414, 0.017451, 0.0175612, 0.017672, 0.0177833,
                        0.0178951, 0.0180075, 0.0181204, 0.0182339, 0.0183479,
                        0.0184624, 0.0185775, 0.0186931, 0.0188092, 0.0189259,
                        0.0190434, 0.0191617, 0.019281, 0.0194012, 0.0195223,
                        0.0196444, 0.0197674, 0.0198913, 0.0200162, 0.020142,
                        0.0202687, 0.0203964, 0.0205249, 0.0206545, 0.0207849,
                        0.0209163, 0.0210486, 0.0211818, 0.021316, 0.021451,
                        0.0215871, 0.021724, 0.0218619, 0.0220007, 0.0221404,
                        0.0222811, 0.0224227, 0.0225652, 0.0227087, 0.0228531,
                        0.0229984, 0.0231447, 0.0232918, 0.0234399, 0.023589,
                        0.023739, 0.0238899, 0.0240417, 0.0241944, 0.0243481,
                        0.0245027, 0.0246583, 0.0248148, 0.0249722, 0.0251305,
                        0.0252898, 0.0254502, 0.0256117, 0.0257743, 0.0259381,
                        0.026103, 0.0262691, 0.0264363, 0.0266046, 0.0267741,
                        0.0269447, 0.0271164, 0.0272893, 0.0274633, 0.0276385,
                        0.0278148, 0.0279922, 0.0281708, 0.0283504, 0.0285313,
                        0.0287132, 0.0288964, 0.0290806, 0.029266, 0.0294525,
                        0.0296401, 0.0298289, 0.0300189, 0.0302099, 0.0304021,
                        0.0305954, 0.0307899, 0.0309855, 0.0311823, 0.0313801,
                        0.0315792, 0.0317795, 0.0319812, 0.0321843, 0.0323889,
                        0.0325949, 0.0328023, 0.0330111, 0.0332214, 0.0334331,
                        0.0336462, 0.0338607, 0.0340767, 0.0342941, 0.0345129,
                        0.0347331, 0.0349547, 0.0351778, 0.0354023, 0.0356282,
                        0.0358556, 0.0360843, 0.0363145, 0.0365461, 0.0367792,
                        0.0370136, 0.0372495, 0.0374868, 0.0377255, 0.0379657,
                        0.0382074, 0.0384509, 0.038696, 0.0389428, 0.0391913,
                        0.0394414, 0.0396933, 0.0399468, 0.0402021, 0.040459,
                        0.0407176, 0.0409778, 0.0412398, 0.0415035, 0.0417688,
                        0.0420358, 0.0423045, 0.0425749, 0.042847, 0.0431208,
                        0.0433962, 0.0436733, 0.0439522, 0.0442327, 0.0445149,
                        0.0447992, 0.0450854, 0.0453735, 0.0456636, 0.0459557,
                        0.0462497, 0.0465457, 0.0468437, 0.0471436, 0.0474454,
                        0.0477493, 0.0480551, 0.0483628, 0.0486725, 0.0489842,
                        0.0492978, 0.0496134, 0.049931, 0.0502505, 0.050572,
                        0.0508955, 0.0512212, 0.0515492, 0.0518794, 0.0522118,
                        0.0525465, 0.0528834, 0.0532226, 0.0535639, 0.0539076,
                        0.0542534, 0.0546015, 0.0549518, 0.0553044, 0.0556592,
                        0.0560162, 0.0563755, 0.056737, 0.0571008, 0.0574669,
                        0.0578356, 0.0582068, 0.0585805, 0.0589567, 0.0593355,
                        0.0597167, 0.0601005, 0.0604868, 0.0608756, 0.0612669,
                        0.0616607, 0.0620571, 0.062456, 0.0628574, 0.0632613,
                        0.0636677, 0.064077, 0.064489, 0.0649038, 0.0653214,
                        0.0657419, 0.0661651, 0.0665911, 0.06702, 0.0674516,
                        0.067886, 0.0683233, 0.0687633, 0.0692061, 0.0696518,
                        0.0701002, 0.0705518, 0.0710064, 0.0714641, 0.0719248,
                        0.0723887, 0.0728557, 0.0733257, 0.0737989, 0.0742751,
                        0.0747544, 0.0752368, 0.0757223, 0.0762109, 0.0767027,
                        0.0771978, 0.0776963, 0.0781982, 0.0787035, 0.0792122,
                        0.0797242, 0.0802396, 0.0807584, 0.0812806, 0.0818062,
                        0.0823351, 0.0828675, 0.0834034, 0.0839429, 0.0844862,
                        0.0850331, 0.0855838, 0.086138, 0.086696, 0.0872576,
                        0.087823, 0.088392, 0.0889646, 0.089541, 0.0901213,
                        0.0907056, 0.0912939, 0.0918862, 0.0924824, 0.0930826,
                        0.0936868, 0.094295, 0.0949071, 0.0955232, 0.0961434,
                        0.0967678, 0.0973965, 0.0980295, 0.0986668, 0.0993083,
                        0.0999541, 0.100604, 0.101259, 0.101917, 0.10258,
                        0.103248, 0.10392, 0.104597, 0.105278, 0.105964,
                        0.106654, 0.107349, 0.108049, 0.108753, 0.109462,
                        0.110176, 0.110895, 0.111619, 0.112347, 0.113081,
                        0.113819, 0.114562, 0.115311, 0.116064, 0.116822,
                        0.117586, 0.118355, 0.119129, 0.119908, 0.120693,
                        0.121483, 0.122278, 0.123078, 0.123884, 0.124696,
                        0.125513, 0.126336, 0.127164, 0.127998, 0.128837,
                        0.129682, 0.130533, 0.13139, 0.132253, 0.133121,
                        0.133996, 0.134876, 0.135762, 0.136655, 0.137554,
                        0.138458, 0.139369, 0.140287, 0.14121, 0.14214,
                        0.143076, 0.144019, 0.144968, 0.145924, 0.146886,
                        0.147855, 0.14883, 0.149812, 0.150801, 0.151797,
                        0.1528, 0.153809, 0.154826, 0.155849, 0.15688,
                        0.157918, 0.158963, 0.160015, 0.161075, 0.162142,
                        0.163216, 0.164298, 0.165387, 0.166484, 0.167588,
                        0.168701, 0.16982, 0.170948, 0.172084, 0.173227,
                        0.174379, 0.175538, 0.176706, 0.177882, 0.179066,
                        0.180258, 0.181459, 0.182668, 0.183886, 0.185112,
                        0.186347, 0.18759, 0.188842, 0.190103, 0.191373,
                        0.192652, 0.19394, 0.195237, 0.196543, 0.197859,
                        0.199184, 0.200518, 0.201861, 0.203214, 0.204577,
                        0.205949, 0.207331, 0.208723, 0.210125, 0.211537,
                        0.212959, 0.214391, 0.215833, 0.217286, 0.218749,
                        0.220222, 0.221706, 0.223201, 0.224706, 0.226222,
                        0.227749, 0.229287, 0.230836, 0.232397, 0.233968,
                        0.235551, 0.237145, 0.238751, 0.240368, 0.241997,
                        0.243638, 0.245291, 0.246956, 0.248633, 0.250322,
                        0.252023, 0.253737, 0.255463, 0.257202, 0.258953,
                        0.260717, 0.262495, 0.264285, 0.266088, 0.267905,
                        0.269734, 0.271578, 0.273435, 0.275305, 0.277189,
                        0.279088, 0.281, 0.282926, 0.284867, 0.286822,
                        0.288791, 0.290775, 0.292774, 0.294787, 0.296816,
                        0.29886, 0.300919, 0.302993, 0.305083, 0.307188,
                        0.309309, 0.311446, 0.313599, 0.315769, 0.317954,
                        0.320156, 0.322375, 0.32461, 0.326862, 0.329131,
                        0.331418, 0.333721, 0.336042, 0.338381, 0.340738,
                        0.343112, 0.345504, 0.347915, 0.350344, 0.352792,
                        0.355259, 0.357744, 0.360248, 0.362772, 0.365315,
                        0.367877, 0.37046, 0.373062, 0.375684, 0.378327,
                        0.38099, 0.383674, 0.386378, 0.389104, 0.39185,
                        0.394618, 0.397408, 0.40022, 0.403053, 0.405909,
                        0.408787, 0.411687, 0.414611, 0.417557, 0.420527,
                        0.42352, 0.426537, 0.429578, 0.432642, 0.435731,
                        0.438845, 0.441983, 0.445147, 0.448335, 0.451549,
                        0.454789, 0.458055, 0.461347, 0.464665, 0.46801,
                        0.471382, 0.474781, 0.478208, 0.481662, 0.485145,
                        0.488655, 0.492195, 0.495763, 0.49936, 0.502986,
                        0.506642, 0.510328, 0.514045, 0.517792, 0.521569,
                        0.525378, 0.529218, 0.53309, 0.536994, 0.540931,
                        0.5449, 0.548902, 0.552937, 0.557007, 0.56111,
                        0.565247, 0.56942, 0.573627, 0.57787, 0.582148,
                        0.586463, 0.590814, 0.595202, 0.599627, 0.60409,
                        0.608591, 0.61313, 0.617708, 0.622325, 0.626982,
                        0.631679, 0.636416, 0.641195, 0.646014, 0.650875,
                        0.655778, 0.660724, 0.665713, 0.670746, 0.675822,
                        0.680943, 0.686109, 0.69132, 0.696576, 0.70188,
                        0.70723, 0.712627, 0.718073, 0.723566, 0.729109,
                        0.734701, 0.740343, 0.746036, 0.751779, 0.757575,
                        0.763422, 0.769322, 0.775276, 0.781284, 0.787346,
                        0.793463, 0.799636, 0.805866, 0.812153, 0.818497,
                        0.8249, 0.831361, 0.837883, 0.844464, 0.851107,
                        0.857811, 0.864578, 0.871408, 0.878302, 0.885261,
                        0.892285, 0.899375, 0.906532, 0.913757, 0.92105,
                        0.928412, 0.935845, 0.943349, 0.950924, 0.958572,
                        0.966293, 0.974089, 0.98196, 0.989907, 0.997931,
                        1.00603, 1.01421, 1.02248, 1.03082, 1.03924,
                        1.04775, 1.05634, 1.06501, 1.07378, 1.08262,
                        1.09156, 1.10059, 1.1097, 1.11891, 1.12821,
                        1.1376, 1.14709, 1.15667, 1.16636, 1.17614,
                        1.18602, 1.196, 1.20608, 1.21627, 1.22656,
                        1.23696, 1.24746, 1.25808, 1.2688, 1.27964,
                        1.29059, 1.30165, 1.31284, 1.32413, 1.33555,
                        1.34709, 1.35876, 1.37054, 1.38245, 1.39449,
                        1.40666, 1.41896, 1.43139, 1.44396, 1.45666,
                        1.46951, 1.48249, 1.49561, 1.50888, 1.52229,
                        1.53585, 1.54956, 1.56342, 1.57744, 1.59161,
                        1.60594, 1.62043, 1.63508, 1.64989, 1.66488,
                        1.68003, 1.69536, 1.71085, 1.72653, 1.74238,
                        1.75842, 1.77464, 1.79104, 1.80764, 1.82443,
                        1.84141, 1.85858, 1.87596, 1.89354, 1.91133,
                        1.92933, 1.94753, 1.96596, 1.98459, 2.00345,
                        2.02254, 2.04185, 2.06139, 2.08116, 2.10117,
                        2.12142, 2.14192, 2.16266, 2.18365, 2.20489,
                        2.2264, 2.24816, 2.27019, 2.29249, 2.31506,
                        2.3379, 2.36103, 2.38444, 2.40814, 2.43213,
                        2.45642, 2.481, 2.50589, 2.53109, 2.5566,
                        2.58243, 2.60858, 2.63506, 2.66186, 2.689,
                        2.71648, 2.74431, 2.77248, 2.801, 2.82988,
                        2.85912, 2.88873, 2.91871, 2.94906, 2.9798,
                        3.01092, 3.04243, 3.07433, 3.10664, 3.13934,
                        3.17246, 3.20599, 3.23993, 3.2743, 3.3091,
                        3.34432, 3.37999, 3.41609, 3.45264, 3.48963,
                        3.52708, 3.56499, 3.60335, 3.64218, 3.68148,
                        3.72125, 3.7615, 3.80223, 3.84343, 3.88513,
                        3.9273, 3.96997, 4.01313, 4.05679, 4.10094,
                        4.14558, 4.19073, 4.23637, 4.28251, 4.32915,
                        4.37629, 4.42392, 4.47205, 4.52068, 4.5698,
                        4.6194, 4.6695, 4.72007, 4.77112, 4.82264,
                        4.87463, 4.92708, 4.97998, 5.03332, 5.0871,
                        5.14131, 5.19592, 5.25095, 5.30636, 5.36216,
                        5.41831, 5.47482, 5.53166, 5.58881, 5.64627,
                        5.704, 5.76199, 5.82022, 5.87866, 5.93729,
                        5.99609, 6.05503, 6.11409, 6.17323, 6.23243,
                        6.29165, 6.35087, 6.41006, 6.46917, 6.52818,
                        6.58705, 6.64575, 6.70423, 6.76247, 6.82042,
                        6.87803, 6.93529, 6.99213, 7.04853, 7.10444,
                        7.15982, 7.21463, 7.26883, 7.32237, 7.37522,
                        7.42733, 7.47867, 7.52919, 7.57885, 7.62762,
                        7.67546, 7.72233, 7.7682, 7.81302, 7.85677,
                        7.89942, 7.94093, 7.98127, 8.02043, 8.05837,
                        8.09506, 8.13049, 8.16464, 8.19749, 8.22901,
                        8.25921, 8.28806, 8.31556, 8.3417, 8.36647 };
   static const double fC[1000] = { 0.0115341, 0.0118039, 0.0120737, 0.0123435, 0.0126134,
                        0.0128832, 0.013153, 0.0134228, 0.0136926, 0.0139624,
                        0.0142322, 0.014502, 0.0147718, 0.0150416, 0.0153115,
                        0.0155813, 0.0158511, 0.0161209, 0.0163907, 0.0166605,
                        0.0169303, 0.0172001, 0.0174699, 0.0177397, 0.0180096,
                        0.0182794, 0.0185492, 0.018819, 0.0190888, 0.0193586,
                        0.0196284, 0.0198982, 0.020168, 0.0204378, 0.0207077,
                        0.0209775, 0.0212473, 0.0215171, 0.0217869, 0.0220567,
                        0.0223265, 0.0225963, 0.0228661, 0.0231359, 0.0234058,
                        0.0236756, 0.0239454, 0.0242152, 0.024485, 0.0247548,
                        0.0250246, 0.0252944, 0.0255642, 0.025834, 0.0261039,
                        0.0263737, 0.0266435, 0.0269133, 0.0271831, 0.0274529,
                        0.0277227, 0.0279925, 0.0282623, 0.0285321, 0.028802,
                        0.0290718, 0.0293416, 0.0296114, 0.0298812, 0.030151,
                        0.0304208, 0.0306906, 0.0309604, 0.0312302, 0.0315001,
                        0.0317699, 0.0320397, 0.0323095, 0.0325793, 0.0328491,
                        0.0331189, 0.0333887, 0.0336585, 0.0339283, 0.0341982,
                        0.034468, 0.0347378, 0.0350076, 0.0352774, 0.0355472,
                        0.035817, 0.0360868, 0.0363566, 0.0366264, 0.0368963,
                        0.0371661, 0.0374359, 0.0377057, 0.0379755, 0.0382453,
                        0.0385151, 0.0387849, 0.0390547, 0.0393245, 0.0395944,
                        0.0398642, 0.040134, 0.0404038, 0.0406736, 0.0409434,
                        0.0412132, 0.041483, 0.0417528, 0.0420226, 0.0422925,
                        0.0425623, 0.0428321, 0.0431019, 0.0433717, 0.0436415,
                        0.0439113, 0.0441811, 0.0444509, 0.0447207, 0.0449906,
                        0.0452604, 0.0455302, 0.0458, 0.0460698, 0.0463396,
                        0.0466094, 0.0468792, 0.047149, 0.0474188, 0.0476887,
                        0.0479585, 0.0482283, 0.0484981, 0.0487679, 0.0490377,
                        0.0493075, 0.0495773, 0.0498471, 0.0501169, 0.0503868,
                        0.0506566, 0.0509264, 0.0511962, 0.051466, 0.0517358,
                        0.0520056, 0.0522754, 0.0525452, 0.052815, 0.0530849,
                        0.0533547, 0.0536245, 0.0538943, 0.0541641, 0.0544339,
                        0.0547037, 0.0549735, 0.0552433, 0.0555131, 0.055783,
                        0.0560528, 0.0563226, 0.0565924, 0.0568622, 0.057132,
                        0.0574018, 0.0576717, 0.0579413, 0.0582117, 0.0584795,
                        0.0589425, 0.059408, 0.0598728, 0.0603378, 0.0608028,
                        0.0612678, 0.0617327, 0.0621977, 0.0626627, 0.0631276,
                        0.0635926, 0.0640576, 0.0645225, 0.0649875, 0.0654525,
                        0.0659174, 0.0663824, 0.0668474, 0.0673124, 0.0677773,
                        0.0682423, 0.0687073, 0.0691722, 0.0696372, 0.0701022,
                        0.0705671, 0.0710321, 0.0714971, 0.071962, 0.072427,
                        0.072892, 0.0733569, 0.0738219, 0.0742869, 0.0747519,
                        0.0752168, 0.0756818, 0.0761468, 0.0766117, 0.0770767,
                        0.0775416, 0.0780068, 0.0784711, 0.0789383, 0.0793952,
                        0.079895, 0.0804744, 0.0810396, 0.0816087, 0.0821767,
                        0.082745, 0.0833133, 0.0838815, 0.0844497, 0.085018,
                        0.0855862, 0.0861545, 0.0867227, 0.087291, 0.0878592,
                        0.0884275, 0.0889957, 0.089564, 0.0901322, 0.0907004,
                        0.0912687, 0.0918369, 0.0924052, 0.0929734, 0.0935417,
                        0.0941099, 0.0946782, 0.0952464, 0.0958147, 0.0963829,
                        0.0969512, 0.0975194, 0.0980876, 0.0986559, 0.099224,
                        0.099793, 0.100505, 0.101217, 0.101929, 0.10264,
                        0.103352, 0.104063, 0.104775, 0.105487, 0.106198,
                        0.10691, 0.107622, 0.108333, 0.109045, 0.109757,
                        0.110468, 0.11118, 0.111892, 0.112603, 0.113315,
                        0.114026, 0.114738, 0.11545, 0.116161, 0.116873,
                        0.117585, 0.118296, 0.119009, 0.119716, 0.120444,
                        0.121296, 0.122136, 0.122979, 0.123821, 0.124664,
                        0.125507, 0.126349, 0.127192, 0.128034, 0.128877,
                        0.12972, 0.130562, 0.131405, 0.132247, 0.13309,
                        0.133932, 0.134775, 0.135618, 0.13646, 0.137303,
                        0.138146, 0.138987, 0.139833, 0.140663, 0.141618,
                        0.142605, 0.143583, 0.144564, 0.145544, 0.146525,
                        0.147505, 0.148485, 0.149466, 0.150446, 0.151426,
                        0.152407, 0.153387, 0.154367, 0.155348, 0.156328,
                        0.157308, 0.158289, 0.159268, 0.160252, 0.161218,
                        0.162297, 0.163425, 0.164541, 0.16566, 0.166778,
                        0.167896, 0.169014, 0.170132, 0.171251, 0.172369,
                        0.173487, 0.174605, 0.175724, 0.176842, 0.17796,
                        0.179078, 0.180197, 0.181313, 0.182441, 0.183707,
                        0.184964, 0.186223, 0.187481, 0.18874, 0.189998,
                        0.191257, 0.192515, 0.193774, 0.195032, 0.196291,
                        0.197549, 0.198808, 0.200066, 0.201328, 0.202572,
                        0.203901, 0.205315, 0.206712, 0.208114, 0.209514,
                        0.210914, 0.212315, 0.213715, 0.215116, 0.216516,
                        0.217917, 0.219317, 0.220717, 0.222121, 0.223507,
                        0.224977, 0.226536, 0.228076, 0.229622, 0.231166,
                        0.23271, 0.234254, 0.235799, 0.237343, 0.238887,
                        0.240432, 0.241975, 0.243523, 0.245055, 0.24672,
                        0.248416, 0.250104, 0.251795, 0.253485, 0.255175,
                        0.256865, 0.258555, 0.260245, 0.261935, 0.263627,
                        0.26531, 0.267026, 0.268877, 0.270711, 0.27255,
                        0.274387, 0.276225, 0.278063, 0.2799, 0.281738,
                        0.283575, 0.285417, 0.287238, 0.289164, 0.291165,
                        0.293148, 0.295136, 0.297123, 0.29911, 0.301097,
                        0.303085, 0.305071, 0.307062, 0.309035, 0.311141,
                        0.313288, 0.315424, 0.317563, 0.319702, 0.32184,
                        0.323979, 0.326116, 0.328259, 0.330381, 0.332622,
                        0.334926, 0.337214, 0.339507, 0.341799, 0.344091,
                        0.346382, 0.348675, 0.350962, 0.353272, 0.355731,
                        0.358175, 0.360623, 0.363069, 0.365517, 0.367963,
                        0.370412, 0.372852, 0.375327, 0.377945, 0.380546,
                        0.383151, 0.385755, 0.38836, 0.390963, 0.393571,
                        0.39616, 0.398892, 0.401663, 0.404424, 0.407188,
                        0.409952, 0.412714, 0.415481, 0.418229, 0.42112,
                        0.424053, 0.426975, 0.429901, 0.432825, 0.43575,
                        0.43867, 0.441613, 0.444713, 0.447797, 0.450885,
                        0.453973, 0.45706, 0.46015, 0.463229, 0.466469,
                        0.469725, 0.472977, 0.47623, 0.479482, 0.482735,
                        0.485986, 0.489404, 0.492824, 0.496244, 0.499662,
                        0.503085, 0.506492, 0.50997, 0.513577, 0.51716,
                        0.52075, 0.524339, 0.527927, 0.531518, 0.535281,
                        0.53904, 0.5428, 0.546559, 0.55032, 0.554074,
                        0.558, 0.561935, 0.565867, 0.569801, 0.57373,
                        0.577675, 0.581791, 0.585897, 0.590005, 0.594117,
                        0.598208, 0.602396, 0.6067, 0.61098, 0.615267,
                        0.61955, 0.623839, 0.628307, 0.632771, 0.637234,
                        0.641703, 0.646151, 0.650765, 0.655419, 0.660061,
                        0.664712, 0.66934, 0.674125, 0.678965, 0.68379,
                        0.688624, 0.693438, 0.698428, 0.703449, 0.708463,
                        0.713474, 0.718501, 0.723713, 0.728911, 0.734119,
                        0.739302, 0.744598, 0.750009, 0.755396, 0.760788,
                        0.766185, 0.771773, 0.777354, 0.782944, 0.788507,
                        0.794235, 0.800024, 0.805803, 0.811562, 0.817439,
                        0.823431, 0.829405, 0.835362, 0.841416, 0.847608,
                        0.853779, 0.859935, 0.866192, 0.872584, 0.878957,
                        0.88531, 0.891799, 0.898391, 0.904967, 0.911525,
                        0.918268, 0.925059, 0.931833, 0.93863, 0.945627,
                        0.952617, 0.959584, 0.96668, 0.973897, 0.981088,
                        0.988288, 0.995696, 1.00311, 1.0105, 1.01803,
                        1.02568, 1.03328, 1.04095, 1.04881, 1.05664,
                        1.06448, 1.07253, 1.08059, 1.08863, 1.09686,
                        1.10516, 1.11341, 1.12184, 1.13036, 1.13883,
                        1.14747, 1.15622, 1.16491, 1.17378, 1.18275,
                        1.19168, 1.20079, 1.20999, 1.21915, 1.22852,
                        1.23795, 1.24735, 1.257, 1.26664, 1.27632,
                        1.28623, 1.29609, 1.30609, 1.31625, 1.32634,
                        1.33668, 1.34704, 1.35744, 1.36808, 1.37866,
                        1.38944, 1.40031, 1.41118, 1.42231, 1.43338,
                        1.44465, 1.45602, 1.46741, 1.47905, 1.49063,
                        1.50246, 1.51432, 1.52629, 1.53844, 1.55058,
                        1.56299, 1.57535, 1.58798, 1.60061, 1.61343,
                        1.62635, 1.63936, 1.65256, 1.66579, 1.67927,
                        1.69274, 1.70648, 1.7202, 1.73421, 1.7482,
                        1.76247, 1.77674, 1.79128, 1.80583, 1.82065,
                        1.83548, 1.85059, 1.86572, 1.88112, 1.89655,
                        1.91225, 1.92799, 1.94399, 1.96005, 1.97636,
                        1.99276, 2.00937, 2.02613, 2.04304, 2.06016,
                        2.07739, 2.09487, 2.11245, 2.13027, 2.14823,
                        2.16638, 2.18475, 2.20324, 2.22199, 2.24088,
                        2.25998, 2.2793, 2.29877, 2.31849, 2.33839,
                        2.35848, 2.37882, 2.39934, 2.42009, 2.44106,
                        2.46223, 2.48364, 2.50529, 2.52713, 2.54923,
                        2.57157, 2.59412, 2.61693, 2.63999, 2.66328,
                        2.68683, 2.71064, 2.7347, 2.75902, 2.78361,
                        2.80846, 2.83359, 2.85898, 2.88467, 2.91063,
                        2.93688, 2.96341, 2.99025, 3.01738, 3.04481,
                        3.07255, 3.1006, 3.12896, 3.15765, 3.18666,
                        3.21599, 3.24566, 3.27566, 3.30601, 3.33671,
                        3.36775, 3.39915, 3.43092, 3.46305, 3.49555,
                        3.52843, 3.56169, 3.59534, 3.62938, 3.66382,
                        3.69867, 3.73393, 3.7696, 3.8057, 3.84222,
                        3.87918, 3.91658, 3.95443, 3.99274, 4.0315,
                        4.07073, 4.11044, 4.15062, 4.1913, 4.23247,
                        4.27414, 4.31633, 4.35903, 4.40226, 4.44602,
                        4.49032, 4.53518, 4.58059, 4.62657, 4.67312,
                        4.72026, 4.76798, 4.81631, 4.86526, 4.91482,
                        4.965, 5.01583, 5.06731, 5.11945, 5.17225,
                        5.22573, 5.2799, 5.33478, 5.39036, 5.44666,
                        5.5037, 5.56148, 5.62001, 5.67932, 5.7394,
                        5.80028, 5.86195, 5.92445, 5.98777, 6.05194,
                        6.11696, 6.18284, 6.24962, 6.31728, 6.38586,
                        6.45535, 6.52579, 6.59718, 6.66954, 6.74288,
                        6.81722, 6.89257, 6.96896, 7.04638, 7.12488,
                        7.20445, 7.28511, 7.36689, 7.4498, 7.53386,
                        7.61908, 7.70549, 7.7931, 7.88193, 7.972,
                        8.06333, 8.15593, 8.24984, 8.34506, 8.44162,
                        8.53953, 8.63883, 8.73952, 8.84164, 8.94519,
                        9.05021, 9.15672, 9.26473, 9.37427, 9.48536,
                        9.59802, 9.71229, 9.82817, 9.94569, 10.0649,
                        10.1858, 10.3083, 10.4327, 10.5588, 10.6866,
                        10.8163, 10.9478, 11.0812, 11.2164, 11.3535,
                        11.4926, 11.6336, 11.7766, 11.9216, 12.0686,
                        12.2176, 12.3687, 12.5219, 12.6772, 12.8346,
                        12.9942, 13.1559, 13.3198, 13.4859, 13.6543,
                        13.8249, 13.9977, 14.1728, 14.3502, 14.5299,
                        14.712, 14.8963, 15.0829, 15.2719, 15.4633,
                        15.6569, 15.853, 16.0513, 16.252, 16.4551,
                        16.6605, 16.8681, 17.0781, 17.2904, 17.5049,
                        17.7217, 17.9407, 18.1618, 18.3851, 18.6105,
                        18.838, 19.0675, 19.2989, 19.5322, 19.7673,
                        20.0041, 20.2427, 20.4828, 20.7244, 20.9673,
                        21.2116, 21.4569, 21.7034, 21.9507, 22.1987,
                        22.4474, 22.6965, 22.9458, 23.1952, 23.4445,
                        23.6934, 23.9418, 24.1894, 24.436, 24.6813,
                        24.925, 25.1669, 25.4067, 25.644, 25.8785,
                        26.1099, 26.3379, 26.562, 26.7819, 26.9971,
                        27.2074, 27.4122, 27.6111, 27.8036, 27.9894,
                        28.1678, 28.3385, 28.5009, 28.6545, 28.7988,
                        28.9332, 29.0573, 29.1704, 29.272, 29.3616,
                        29.4386, 29.5024, 29.5526, 29.5885, 29.6096,
                        29.6154, 29.6053, 29.5788, 29.5355, 29.4749,
                        29.3964, 29.2997, 29.1844, 29.05, 28.8963,
                        28.7229, 28.5295, 28.316, 28.082, 27.8276,
                        27.5525, 27.2567, 26.9402, 26.6031, 26.2454,
                        25.8674, 25.4692, 25.0512, 24.6136, 24.1569,
                        23.6814, 23.1878, 22.6765, 22.1482, 21.6035,
                        21.0431, 20.4678, 19.8784, 19.2757, 18.6607,
                        18.0342, 17.3972, 16.7506, 16.0955, 15.4328,
                        14.7636, 14.0889, 13.41, 12.727, 0.001 };
   static const double fD[1000] = { 0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899367, 0.0899367, 0.0899367,
                        0.0899367, 0.0899367, 0.0899364, 0.0899376, 0.0899334,
                        0.089949, 0.0898908, 0.0901078, 0.089298, 0.154315,
                        0.15517, 0.154941, 0.155002, 0.154986, 0.15499,
                        0.154989, 0.15499, 0.15499, 0.15499, 0.15499,
                        0.15499, 0.15499, 0.15499, 0.15499, 0.15499,
                        0.15499, 0.15499, 0.15499, 0.15499, 0.15499,
                        0.15499, 0.15499, 0.15499, 0.15499, 0.15499,
                        0.15499, 0.15499, 0.15499, 0.15499, 0.15499,
                        0.15499, 0.15499, 0.15499, 0.15499, 0.15499,
                        0.154989, 0.15499, 0.154989, 0.154993, 0.154976,
                        0.155041, 0.154797, 0.155707, 0.152311, 0.166606,
                        0.193119, 0.188423, 0.189681, 0.189344, 0.189434,
                        0.18941, 0.189417, 0.189415, 0.189415, 0.189415,
                        0.189415, 0.189415, 0.189415, 0.189415, 0.189415,
                        0.189415, 0.189415, 0.189415, 0.189415, 0.189415,
                        0.189415, 0.189415, 0.189415, 0.189415, 0.189415,
                        0.189415, 0.189415, 0.189415, 0.189415, 0.189415,
                        0.189417, 0.18941, 0.189434, 0.189346, 0.189672,
                        0.237464, 0.237148, 0.237232, 0.23721, 0.237216,
                        0.237214, 0.237215, 0.237215, 0.237215, 0.237215,
                        0.237215, 0.237215, 0.237215, 0.237215, 0.237215,
                        0.237215, 0.237215, 0.237215, 0.237215, 0.237215,
                        0.237215, 0.237214, 0.237216, 0.237208, 0.237241,
                        0.237117, 0.237577, 0.235861, 0.242419, 0.284031,
                        0.28001, 0.281088, 0.280799, 0.280876, 0.280855,
                        0.280861, 0.28086, 0.28086, 0.28086, 0.28086,
                        0.28086, 0.28086, 0.28086, 0.28086, 0.28086,
                        0.28086, 0.280858, 0.280866, 0.280838, 0.280941,
                        0.280558, 0.281986, 0.276657, 0.318239, 0.328936,
                        0.326202, 0.326935, 0.326739, 0.326791, 0.326777,
                        0.326781, 0.32678, 0.32678, 0.32678, 0.32678,
                        0.32678, 0.326781, 0.326778, 0.326787, 0.326755,
                        0.326873, 0.326433, 0.328075, 0.321949, 0.359702,
                        0.375862, 0.371911, 0.372969, 0.372686, 0.372762,
                        0.372741, 0.372747, 0.372745, 0.372746, 0.372746,
                        0.372745, 0.372747, 0.372741, 0.372763, 0.37268,
                        0.372992, 0.371826, 0.376224, 0.421998, 0.41884,
                        0.419686, 0.419459, 0.41952, 0.419503, 0.419508,
                        0.419507, 0.419507, 0.419505, 0.419513, 0.419483,
                        0.419597, 0.419169, 0.420768, 0.414799, 0.442705,
                        0.471623, 0.465539, 0.467169, 0.466732, 0.466849,
                        0.466818, 0.466827, 0.466822, 0.466831, 0.4668,
                        0.466915, 0.466486, 0.468087, 0.462113, 0.489779,
                        0.519692, 0.513464, 0.515133, 0.514685, 0.514805,
                        0.514774, 0.51478, 0.514785, 0.514758, 0.514862,
                        0.514472, 0.51593, 0.510487, 0.554993, 0.565476,
                        0.562783, 0.563505, 0.563312, 0.563362, 0.563352,
                        0.563342, 0.563395, 0.563194, 0.563944, 0.561144,
                        0.572064, 0.616958, 0.611373, 0.612869, 0.612469,
                        0.612574, 0.612554, 0.612527, 0.612655, 0.612171,
                        0.613979, 0.607232, 0.641947, 0.666844, 0.661188,
                        0.662704, 0.662296, 0.662413, 0.662352, 0.662479,
                        0.662034, 0.663687, 0.657519, 0.70218, 0.715506,
                        0.712137, 0.713037, 0.712805, 0.712834, 0.712951,
                        0.712455, 0.714321, 0.707352, 0.746801, 0.767912,
                        0.76289, 0.764238, 0.763867, 0.764002, 0.763833,
                        0.764377, 0.762371, 0.770024, 0.819421, 0.814698,
                        0.815967, 0.815613, 0.815761, 0.815524, 0.816323,
                        0.813362, 0.824898, 0.872761, 0.866833, 0.86843,
                        0.867972, 0.868208, 0.86772, 0.869434, 0.863066,
                        0.910432, 0.923804, 0.920417, 0.921293, 0.921175,
                        0.920772, 0.922502, 0.915986, 0.963658, 0.977609,
                        0.974066, 0.975053, 0.974649, 0.975279, 0.973162,
                        0.981184, 1.03308, 1.02813, 1.02944, 1.02915,
                        1.02899, 1.02993, 1.02634, 1.08027, 1.08522,
                        1.0839, 1.08427, 1.08413, 1.08432, 1.08368,
                        1.13934, 1.13998, 1.13991, 1.13955, 1.14106,
                        1.13539, 1.15938, 1.20228, 1.19459, 1.19662,
                        1.19617, 1.19595, 1.19728, 1.25421, 1.25295,
                        1.25333, 1.25307, 1.25373, 1.25134, 1.30863,
                        1.31155, 1.31068, 1.31125, 1.30986, 1.31489,
                        1.37217, 1.36862, 1.3691, 1.37075, 1.36367,
                        1.39612, 1.43452, 1.42668, 1.42889, 1.42788,
                        1.4297, 1.48923, 1.48789, 1.4878, 1.48951,
                        1.48278, 1.53813, 1.55129, 1.54739, 1.55037,
                        1.54237, 1.59521, 1.61331, 1.60838, 1.61121,
                        1.60482, 1.66334, 1.67355, 1.67123, 1.67056,
                        1.6756, 1.73725, 1.73276, 1.73596, 1.72766,
                        1.76538, 1.80364, 1.79569, 1.79732, 1.79876,
                        1.86284, 1.86037, 1.86314, 1.85453, 1.90931,
                        1.9295, 1.9266, 1.91957, 1.95896, 1.99744,
                        1.99111, 1.98593, 2.01771, 2.06409, 2.05715,
                        2.05177, 2.08575, 2.13086, 2.12426, 2.11757,
                        2.16287, 2.19763, 2.19178, 2.18614, 2.24765,
                        2.26364, 2.25782, 2.26584, 2.33237, 2.33006,
                        2.3223, 2.36514, 2.40588, 2.39692, 2.40001,
                        2.4692, 2.4714, 2.46191, 2.51213, 2.54798,
                        2.5353, 2.55621, 2.61947, 2.6112, 2.61223,
                        2.68369, 2.68767, 2.67883, 2.74474, 2.76464,
                        2.75032, 2.80885, 2.84106, 2.82399, 2.87847,
                        2.91706, 2.89874, 2.95421, 2.99296, 2.97448,
                        3.03613, 3.06846, 3.05228, 3.12372, 3.14258,
                        3.13493, 3.21492, 3.21423, 3.22757, 3.30403,
                        3.28614, 3.33238, 3.38526, 3.36594, 3.44426,
                        3.45586, 3.46684, 3.54655, 3.52626, 3.59072,
                        3.62439, 3.62283, 3.70948, 3.69166, 3.75702,
                        3.78962, 3.79618, 3.88017, 3.86034, 3.94361,
                        3.95156, 3.9919, 4.04963, 4.04686, 4.13705,
                        4.12022, 4.20904, 4.20965, 4.27295, 4.30565,
                        4.33813, 4.40108, 4.40948, 4.49314, 4.48827,
                        4.58189, 4.57362, 4.66897, 4.66361, 4.75653,
                        4.75633, 4.84627, 4.85062, 4.93905, 4.94612,
                        5.03503, 5.04307, 5.13385, 5.14224, 5.23455,
                        5.24501, 5.33573, 5.35293, 5.43619, 5.46688,
                        5.53581, 5.58631, 5.63628, 5.70852, 5.74177,
                        5.82819, 5.85847, 5.94062, 5.98782, 6.04884,
                        6.12223, 6.16426, 6.2495, 6.29716, 6.36655,
                        6.43975, 6.48995, 6.57373, 6.63321, 6.69842,
                        6.78068, 6.83869, 6.91487, 6.99293, 7.05571,
                        7.13702, 7.21433, 7.28244, 7.36583, 7.44571,
                        7.51856, 7.60238, 7.68696, 7.76457, 7.84775,
                        7.93772, 8.02034, 8.10478, 8.19637, 8.28621,
                        8.37454, 8.46487, 8.56125, 8.65464, 8.74899,
                        8.84465, 8.94487, 9.04437, 9.14416, 9.24584,
                        9.34918, 9.45576, 9.56153, 9.66906, 9.77822,
                        9.88883, 10.0019, 10.1161, 10.2314, 10.3485,
                        10.4672, 10.5877, 10.7099, 10.8341, 10.9599,
                        11.0873, 11.2165, 11.3476, 11.4807, 11.6156,
                        11.7525, 11.8913, 12.0322, 12.175, 12.32,
                        12.4671, 12.6163, 12.7676, 12.9212, 13.0771,
                        13.2352, 13.3956, 13.5584, 13.7237, 13.8914,
                        14.0615, 14.2342, 14.4095, 14.5874, 14.7679,
                        14.9511, 15.1371, 15.3259, 15.5174, 15.7121,
                        15.9097, 16.1101, 16.3135, 16.52, 16.7295,
                        16.9427, 17.1593, 17.3785, 17.6012, 17.827,
                        18.0576, 18.2909, 18.5274, 18.7673, 19.0129,
                        19.2606, 19.5113, 19.7681, 20.0285, 20.2904,
                        20.5596, 20.8322, 21.1062, 21.3896, 21.6727,
                        21.9622, 22.2578, 22.5533, 22.8603, 23.1643,
                        23.4808, 23.795, 24.121, 24.4453, 24.7815,
                        25.1161, 25.4628, 25.8085, 26.1647, 26.5236,
                        26.8882, 27.2608, 27.6359, 28.0192, 28.4082,
                        28.8019, 29.2029, 29.6103, 30.023, 30.4424,
                        30.8687, 31.3014, 31.7404, 32.1862, 32.6388,
                        33.0984, 33.5649, 34.0383, 34.5188, 35.0065,
                        35.5015, 36.0037, 36.5134, 37.0305, 37.555,
                        38.0872, 38.627, 39.1745, 39.7296, 40.2926,
                        40.8633, 41.4419, 42.0284, 42.6227, 43.225,
                        43.835, 44.4531, 45.0793, 45.7129, 46.3543,
                        47.0044, 47.6611, 48.3261, 48.9991, 49.6784,
                        50.3669, 51.0606, 51.7637, 52.4717, 53.1885,
                        53.9104, 54.6396, 55.375, 56.1158, 56.8628,
                        57.6151, 58.3722, 59.134, 59.9001, 60.6701,
                        61.4434, 62.2195, 62.9979, 63.778, 64.5593,
                        65.3409, 66.1222, 66.9025, 67.6808, 68.4563,
                        69.2282, 69.9953, 70.7565, 71.5108, 72.2571,
                        72.994, 73.7199, 74.4341, 75.1341, 75.8194,
                        76.4872, 77.1367, 77.7653, 78.3716, 78.9532,
                        79.508, 80.0337, 80.5281, 80.9885, 81.4123,
                        81.7969, 82.1394, 82.4369, 82.6861, 82.884,
                        83.0272, 83.1122, 83.1355, 83.0933, 82.9819,
                        82.7972, 82.5353, 82.1919, 81.7629, 81.2437,
                        80.6301, 79.9173, 79.1007, 78.1758, 77.1377,
                        75.9817, 74.703, 73.2966, 71.758, 70.0822,
                        68.2647, 66.3007, 64.1857, 61.9153, 59.4855,
                        56.8921, 54.1312, 51.1994, 48.0934, 44.8103,
                        41.3477, 37.7034, 33.8756, 29.8634, 25.6661,
                        21.2836, 16.7167, 11.9664, 7.0349, 1.92482,
                        -3.36024, -8.81611, -14.4375, -20.2184, -26.152,
                        -32.2302, -38.4445, -44.7852, -51.2415, -57.802,
                        -64.4543, -71.1851, -77.9802, -84.8247, -91.703,
                        -98.5985, -105.494, -112.373, -119.216, -126.005,
                        -132.721, -139.346, -145.86, -152.244, -158.48,
                        -164.549, -170.432, -176.111, -181.571, -186.793,
                        -191.762, -196.464, -200.885, -205.012, -208.835,
                        -212.341, -215.524, -218.375, -220.89, -223.058,
                        -224.9, -226.323, -227.667, -227.667, 0.000464102 };
   int klow = 0;
   if(x>fXmin) {
     klow = int((x-fXmin)/fDelta);
     if (klow > fNp-1) klow = fNp-1;
   }
   double dx = x-(klow+0.5)*fDelta;
   return (fY[klow]+dx*(fB[klow]+dx*(fC[klow]+dx*fD[klow])));
}
